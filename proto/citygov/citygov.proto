syntax = "proto3";
package citygov;

option go_package = "github.com/chains-lab/cities-dir-proto/gen/go/citygov;citygov";

import "google/protobuf/empty.proto";
import "common/userdata/userdata.proto";;
import "common/pagination/pagination.proto";

service CityGovService {
  rpc CreateCityOwner (CreateCityOwnerRequest) returns (CityAdmin);
  rpc DeleteCityOwner (DeleteCityOwnerRequest) returns (google.protobuf.Empty);

  rpc TransferOwnership (TransferOwnershipRequest) returns (CityAdmin);

  rpc CreateCityAdmin (CreateCityAdminRequest)     returns (CityAdmin);
  rpc UpdateCityAdmin (UpdateCityAdminRequest)     returns (CityAdmin);
  rpc DeleteCityAdmin (DeleteCityAdminRequest)     returns (google.protobuf.Empty);

  rpc RefuseCityAdminRight (RefuseCityAdminRightRequest)     returns (google.protobuf.Empty);

  rpc GetCityAdmin     (GetCityAdminRequest)        returns (CityAdmin);
  rpc ListCityAdmins   (ListCityAdminsRequest)      returns (ListCitiesAdmins);
}

// REQUESTS

message CreateCityOwnerRequest {
  optional userdata.UserData initiator = 1;
  string city_id = 2;
  string user_id = 3;
}

message DeleteCityOwnerRequest {
  optional userdata.UserData initiator = 1;
  string city_id = 2;
  string user_id = 3;
}

message TransferOwnershipRequest {
  optional userdata.UserData initiator = 1;
  string city_id        = 2;
  string new_owner_id   = 3;
}

message CreateCityAdminRequest {
  optional userdata.UserData initiator = 1;
  string city_id = 2;
  string user_id = 3;
  string role    = 4;
}

message UpdateCityAdminRequest {
  optional userdata.UserData initiator = 1;
  string city_id = 2;
  string user_id = 3;
  string role    = 4;
}

message DeleteCityAdminRequest {
  optional userdata.UserData initiator = 1;
  string city_id = 2;
  string user_id = 3;
}

message RefuseCityAdminRightRequest {
  optional userdata.UserData initiator = 1;
  string city_id = 2;
  string user_id = 3;
}

message GetCityAdminRequest {
  string city_id = 1;
  string user_id = 2;
}

message ListCityAdminsRequest {
  string city_id = 1;
  pagination.Request pagination = 2;
}

// --------------------
// ---- RESPONSES ----
// --------------------

message CityAdmin {
  string city_id = 1;
  string user_id = 2;
  string role    = 3;
}

message ListCitiesAdmins {
  repeated CityAdmin admins     = 1;
  pagination.Response pagination = 2;
}